<? namespace Bitrix\Main\Security\W\Rules;$GLOBALS['____719915758']= array(base64_decode(''.'aX'.'Nfc3RyaW5n'),base64_decode(''.'c'.'3RydG9sb'.'3'.'dlcg=='),base64_decode('a'.'X'.'N'.'fY'.'XJyYXk='),base64_decode('a'.'X'.'Nfc3Ry'.'aW5n'),base64_decode(''.'Z'.'3p'.'kZW'.'NvZ'.'G'.'U='),base64_decode(''.'YmFz'.'ZTY0X2'.'Rl'.'Y2'.'9kZQ'.'=='),base64_decode(''.'dXJsZ'.'GVjb2Rl'),base64_decode(''.'YXJyYXlf'.'cmV2ZX'.'J'.'zZQ=='),base64_decode('Z3p'.'lbmNvZG'.'U='),base64_decode('Ym'.'Fz'.'ZTY'.'0X2VuY29kZ'.'Q=='),base64_decode('dXJs'.'ZW5jb2Rl'),base64_decode('YmluMmhleA=='),base64_decode('aXNfYXJy'.'YX'.'k='),base64_decode('c3Ryd'.'G9sb3dlcg=='),base64_decode('aXNf'.'Y'.'XJ'.'yYXk'.'='),base64_decode('a'.'m9'.'pb'.'g'.'=='),base64_decode(''.'Zm5tY'.'XR'.'ja'.'A'.'=='),base64_decode('cmF3'.'d'.'XJsZGVjb2R'.'l'),base64_decode('c'.'3Vic3Ry'),base64_decode('c3'.'Vic3R'.'y'),base64_decode('c'.'3RyX3JlcGxh'.'Y2U='),base64_decode('cHJlZ19'.'xd'.'W90ZQ=='),base64_decode('cHJlZ'.'19tY'.'XRjaA='.'='));if(!function_exists(__NAMESPACE__.'\\___2121009006')){function ___2121009006($_804674285){static $_473093616= false; if($_473093616 == false) $_473093616=array('YWN0a'.'W9'.'u','aW50dmF'.'s',''.'cGF0aA==','Y2'.'9udG'.'V4'.'dA==','a2V'.'5cw==','cHJvY2V'.'zcw==',''.'ZW5jb'.'2'.'Rpb'.'mc=','c'.'HJ'.'lZ1'.'9yZX'.'B'.'s'.'YWNl','cGF0aA'.'==','Y2'.'9'.'udGV4dA'.'==','a2V5cw'.'==','c'.'HJvY2Vzcw'.'==','ZW5jb2Rpbmc=','cGF0dGVybg==','cHJlZ1'.'9'.'tYXRjaA==',''.'cGF0'.'aA'.'==','Y'.'29'.'udGV4d'.'A==','a'.'2V'.'5cw==','cHJ'.'vY'.'2Vzcw='.'=','ZW'.'5jb2Rpbmc=','cGF0dG'.'Vybg='.'=','cG9'.'zdF9hY3Rpb24=','Y2h'.'lY2tfY3NyZg'.'='.'=','cGF0'.'aA'.'==','Y29ud'.'GV'.'4d'.'A==','a'.'2V5'.'cw='.'=','cHJvY2Vzc'.'w==','ZW5'.'jb2'.'Rpbm'.'c=','cGF0dG'.'Vybg==','Y'.'WN0aW9u','YWN0aW9u','Y'.'WN0aW9u','YWN0a'.'W9u','YWN0aW9u',''.'YWN'.'0aW9u','cG9zd'.'F9'.'hY3Rpb24=','ZW5j'.'b2Rpbm'.'c=','ZW'.'5jb2Rpbmc'.'=','ZW5jb2R'.'pbmc=','ZW5'.'jb'.'2R'.'pbmc=','ZW5j'.'b2'.'Rpbmc=','ZW'.'5jb2Rpbmc'.'=','Z3o=',''.'YmFzZTY0','dXJs','aG'.'V4','Lg==','L'.'w='.'=','aW5'.'k'.'ZXguc'.'Gh'.'w','L2luZ'.'GV'.'4LnBocA==',''.'U'.'0NSSVBUX'.'05'.'B'.'TUU=','L2l'.'uZG'.'V4L'.'n'.'B'.'ocA==',''.'U0NSS'.'VB'.'UX05BTUU'.'=',''.'U0'.'NS'.'SVBU'.'X05BTUU'.'=','U0'.'NSSVB'.'UX0'.'5'.'BTUU=','fg==','fl4'.'=',''.'fg='.'=',''.'XH'.'4=','JH4=');return base64_decode($_473093616[$_804674285]);}}; use Bitrix\Main\IO\Path; use Bitrix\Main\Web\Uri; use Bitrix\Main\Security\W\Rules\Results\ModifyResult; abstract class Rule{ protected $_61806939; protected $_656835639; protected $_140798216; protected $_657290607; protected $_955567720; public static function make(array $_503533147):?static{ $_503533147= static::prepareRuleParameters($_503533147); return match($_503533147[___2121009006(0)]){ ___2121009006(1) => new IntvalRule( $_503533147[___2121009006(2)], $_503533147[___2121009006(3)], $_503533147[___2121009006(4)], $_503533147[___2121009006(5)], $_503533147[___2121009006(6)]), ___2121009006(7) => new PregReplaceRule( $_503533147[___2121009006(8)], $_503533147[___2121009006(9)], $_503533147[___2121009006(10)], $_503533147[___2121009006(11)], $_503533147[___2121009006(12)], $_503533147[___2121009006(13)]), ___2121009006(14) => new PregMatchRule( $_503533147[___2121009006(15)], $_503533147[___2121009006(16)], $_503533147[___2121009006(17)], $_503533147[___2121009006(18)], $_503533147[___2121009006(19)], $_503533147[___2121009006(20)], $_503533147[___2121009006(21)]), ___2121009006(22) => new CsrfRule( $_503533147[___2121009006(23)], $_503533147[___2121009006(24)], $_503533147[___2121009006(25)], $_503533147[___2121009006(26)], $_503533147[___2121009006(27)], $_503533147[___2121009006(28)],), default => null,};} protected static function prepareRuleParameters(array $_192868763): array{ if($GLOBALS['____719915758'][0]($_192868763[___2121009006(29)])){ $_192868763[___2121009006(30)]= $GLOBALS['____719915758'][1]($_192868763[___2121009006(31)]);} elseif($GLOBALS['____719915758'][2]($_192868763[___2121009006(32)])){ $_1549722449= $_192868763[___2121009006(33)]; $_192868763[___2121009006(34)]= $_1549722449[(962-2*481)]; $_192868763[___2121009006(35)]= $_1549722449[round(0+0.5+0.5)];} $_192868763[___2121009006(36)]=!empty($_192868763[___2121009006(37)])? $_192868763[___2121009006(38)]:[]; if($GLOBALS['____719915758'][3]($_192868763[___2121009006(39)])){ $_192868763[___2121009006(40)]=[$_192868763[___2121009006(41)]];} return $_192868763;}  public function __construct($_61806939, $_656835639, $_140798216, $_657290607, $_955567720){ $this->_61806939= $_61806939; $this->_656835639= $this->castContext($_656835639); $this->_140798216= $this->castKeys($_140798216); $this->_657290607= $_657290607; $this->_955567720= $_955567720;} public function evaluateValue($_1821836421){ if(!empty($this->_955567720)){ foreach($this->_955567720 as $_1641338786){ $_1821836421= match($_1641338786){ 'gz' => $GLOBALS['____719915758'][4]($_1821836421), 'base64' => $GLOBALS['____719915758'][5]($_1821836421), 'url' => $GLOBALS['____719915758'][6]($_1821836421), 'hex' => hex2bin($_1821836421)};}} $_1934871520= $this->evaluate($_1821836421); if(!empty($this->_955567720) && $_1934871520 instanceof ModifyResult){ $_948033596= $_1934871520->getCleanValue(); foreach($GLOBALS['____719915758'][7]($this->_955567720) as $_1641338786){ $_948033596= match($_1641338786){ ___2121009006(42) => $GLOBALS['____719915758'][8]($_948033596), ___2121009006(43) => $GLOBALS['____719915758'][9]($_948033596), ___2121009006(44) => $GLOBALS['____719915758'][10]($_948033596), ___2121009006(45) => $GLOBALS['____719915758'][11]($_948033596)};} $_1934871520= new ModifyResult($_948033596);} return $_1934871520;} abstract public function evaluate($_1821836421); protected function castContext($_656835639){ if(!$GLOBALS['____719915758'][12]($_656835639)){ $_656835639=[$_656835639];} foreach($_656835639 as $_50683049 => $_997726980){ $_656835639[$_50683049]= $GLOBALS['____719915758'][13]($_997726980);} return $_656835639;} protected function castKeys($_140798216){ if(!$GLOBALS['____719915758'][14]($_140798216)){ $_140798216=[$_140798216];} return $_140798216;} public function matchKey(array $_872642246): bool{ $_872642246= $GLOBALS['____719915758'][15](___2121009006(46), $_872642246); foreach($this->_140798216 as $_2084328724){   if($GLOBALS['____719915758'][16]($_2084328724, $_872642246)){ return true;}} return false;}  public function matchPath($_404163405){ if($this->_61806939 === '*'){ return true;}  $_2139786504= new Uri($_404163405); $_1071773283= $_2139786504->getPath(); $_1071773283= $GLOBALS['____719915758'][17]($_1071773283);      if(str_ends_with($_1071773283, ___2121009006(47))){ $_1071773283 .= ___2121009006(48);} $_1071773283= Path::normalize($_1071773283);  $_1853285740[]= $_1071773283; if(str_ends_with($_1071773283, ___2121009006(49))){ $_1853285740[]= $GLOBALS['____719915758'][18]($_1071773283,(1288/2-644),-round(0+3+3+3));} elseif(str_ends_with($_SERVER[___2121009006(50)], ___2121009006(51))){ $_1853285740[]= $GLOBALS['____719915758'][19]($_SERVER[___2121009006(52)],(868-2*434),-round(0+2.25+2.25+2.25+2.25));} if($_1071773283 !== $_SERVER[___2121009006(53)]){ $_1853285740[]= $_SERVER[___2121009006(54)];}  if(str_starts_with($this->_61806939, ___2121009006(55))){ $_409503557= $this->_61806939;} else{ $_409503557= ___2121009006(56). $GLOBALS['____719915758'][20](___2121009006(57), ___2121009006(58), $GLOBALS['____719915758'][21]($this->_61806939)). ___2121009006(59);} foreach($_1853285740 as $_700600777){ if($this->_61806939 === $_700600777 || $GLOBALS['____719915758'][22]($_409503557, $_700600777)){ return true;}} return false;}  public function getPath(){ return $this->_61806939;}  public function getContext(){ return $this->_656835639;}  public function getKeys(){ return $this->_140798216;}  public function getProcess(){ return $this->_657290607;}}?>